var svv;(()=>{"use strict";var e={d:(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){let t=e.getContext("webgl",{preserveDrawingBuffer:!0}),r=new THREE.WebGLRenderer({canvas:e,antialias:!0,preserveDrawingBuffer:!0});return r.setClearColor("#FFFFFF"),[t,r]}e.r(t),e.d(t,{App:()=>i});class i extends class{constructor({el:e}){[this.ctx,this.renderer]=r(e),this.renderer.setClearColor("#FFFFFF"),this.el=e,this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,e.width/e.height,.1,3e3)}setup(){}update(e){throw console.error("{{update}} not implemented"),Error("no implementation")}draw(){this.renderer.render(this.scene,this.camera)}toDataURL(){return this.el.toDataURL("image/png")}}{constructor({el:e}){super(...arguments),this.el=e,[this.ctx,this.renderer]=r(e),this.renderer.setClearColor(0),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,e.width/e.height,.1,3e3),console.log("(>o_o)> damn..."),this.generateCity(),this.scene.add(new THREE.AmbientLight(14540253,.1));let t=new THREE.DirectionalLight(12004039,.2);t.position.set(0,10,0),t.target.position.set(1,0,5),this.scene.add(t),this.scene.add(t.target),this.scene.fog=new THREE.Fog(13158,10,60),this.generateLogo();let i=new THREE.PointLight(16777215,.3);i.position.set(0,10,0),this.scene.add(i),this.center=new THREE.Vector3(0,10,0),this.target=new THREE.Vector3(10,4,0)}generateLogo(){let e=new THREE.WebGLCubeRenderTarget(256,{format:THREE.RGBFormat,generateMipmaps:!0,minFilter:THREE.LinearMipmapLinearFilter,encoding:THREE.sRGBEncoding}),t=new THREE.CubeCamera(1,1e4,e);this.logoCubeCamera=t;let r=this.scene;(new THREE.FontLoader).load("helvetiker.json",function(i){let n=new THREE.TextGeometry("TRAX",{font:i,size:1,height:1}),o=new THREE.MeshBasicMaterial({envMap:e.texture,combine:THREE.MultiplyOperation,reflectivity:.9}),a=new THREE.Mesh(n,o);a.position.set(10,5,-2),t.position.set(10,5,-2),a.lookAt(-.2,10,.3),this.logo=a,r.add(a)}.bind(this))}generateCity(){console.log(function(e){var t=document.createElement("canvas");t.width=32,t.height=64,(o=t.getContext("2d")).fillStyle="#ffffff",o.fillRect(0,0,32,64);for(var r=2;r<64;r+=2)for(var i=0;i<32;i+=2){var n=Math.floor(64*Math.random());o.fillStyle="rgb("+[n,n,n].join(",")+")",o.fillRect(i,r,2,1)}var o,a=document.createElement("canvas");a.width=512,a.height=1024,(o=a.getContext("2d")).imageSmoothingEnabled=!1,o.webkitImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,o.drawImage(t,0,0,a.width,a.height);var s=new THREE.Texture(a);return s.anisotropy=e.capabilities.getMaxAnisotropy(),s.needsUpdate=!0,s}(this.renderer));for(let e=0;e<=20;e++)for(let t=-10;t<=10;t++){let r=1,i=5+7*Math.random(),n=2*e,o=2*t,a=new THREE.BoxGeometry(r,i,r),s=new THREE.MeshPhysicalMaterial({emissive:4655533,roughness:.5}),h=new THREE.Mesh(a,s);h.position.set(n,0,o),this.scene.add(h)}}move({x:e,y:t}){this.target.y=0+6*t,this.target.z=0+6*e}update(){if(this.camera.position.x=this.center.x,this.camera.position.y=this.center.y,this.camera.position.z=this.center.z,this.camera.lookAt(this.target),this.logo){let e=+new Date/1e3;this.logo.rotation.x=e}}draw(){this.renderer.render(this.scene,this.camera),this.logoCubeCamera.update(this.renderer,this.scene)}}svv=t})();